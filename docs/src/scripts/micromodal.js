var e=(()=>{var e=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],t={openTrigger:"data-micromodal-trigger",identifier:"data-micromodal-id"},o={},i=[],n=0;t.generateId=()=>"micromodal-".concat(++n);class s{constructor(e){var{targetModal:t,triggers:o=[],onShow:i=()=>{},onClose:n=()=>{},openTrigger:s="data-micromodal-trigger",closeTrigger:a="data-micromodal-close",openClass:r="is-open",disableScroll:l=!1,disableFocus:c=!1,awaitCloseAnimation:h=!1,awaitOpenAnimation:g=!1,debugMode:m=!1}=e;this.modal="string"==typeof t?document.getElementById(t):t,this.modalId=null,null!==this.modal?(this.config={debugMode:m,disableScroll:l,openTrigger:s,closeTrigger:a,openClass:r,onShow:i,onClose:n,awaitCloseAnimation:h,awaitOpenAnimation:g,disableFocus:c},this.showModal=this.showModal.bind(this),this._onClick=this._onClick.bind(this),this._onKeydown=this._onKeydown.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._mouseDownOnOverlay=!1,this.triggers=o,this.registerTriggers()):!0===m&&d(t,m,!1)}registerTriggers(){this.triggers.filter(Boolean).forEach(e=>{e.addEventListener("click",this.showModal)})}unregisterTriggers(){this.triggers.filter(Boolean).forEach(e=>{e.removeEventListener("click",this.showModal)})}destroy(){this.closeModal(),this.unregisterTriggers()}showModal(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.modal.classList.contains(this.config.openClass)||(this.removeEventListeners(),this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.toggleScrolling(!1),this.addEventListeners(),this.modalId&&-1===i.indexOf(this.modalId)&&i.push(this.modalId),this.config.awaitOpenAnimation?this.modal.addEventListener("animationend",this.setFocusToFirstNode,{once:!0}):this.setFocusToFirstNode(),this.config.onShow(this.modal,this.activeElement,e))}closeModal(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.modal,o=this.config.openClass;if(t.classList.contains(o)){var n=i.indexOf(this.modalId);n>-1&&i.splice(n,1),this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.toggleScrolling(!0),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,e),this.config.awaitCloseAnimation?this.modal.addEventListener("animationend",function(){t.classList.remove(o)},{once:!0}):t.classList.remove(o)}}toggleScrolling(e){this.config.disableScroll&&(document.body.style.overflow=e?"":"hidden",document.body.style.touchAction=e?"":"none")}addEventListeners(){this.modal.addEventListener("click",this._onClick),this.modal.addEventListener("keydown",this._onKeydown),this.modal.addEventListener("mousedown",this._onPointerDown),this.modal.addEventListener("touchstart",this._onPointerDown),this.modalId?0===i.length&&document.addEventListener("keydown",r):document.removeEventListener("keydown",r)}removeEventListeners(){this.modal.removeEventListener("click",this._onClick),this.modal.removeEventListener("keydown",this._onKeydown),this.modal.removeEventListener("mousedown",this._onPointerDown),this.modal.removeEventListener("touchstart",this._onPointerDown),0===i.length&&document.removeEventListener("keydown",r)}_onClick(e){var t=l(e.target,this.modal),o=e.target.closest("[".concat(this.config.closeTrigger,"]"));(e.target.hasAttribute(this.config.closeTrigger)&&t&&this._mouseDownOnOverlay||null!==o&&!l(o,this.modal))&&(e.preventDefault(),e.stopPropagation(),this.closeModal(e)),this._mouseDownOnOverlay=!1}_onPointerDown(e){this._mouseDownOnOverlay=l(e.target,this.modal)}_onKeydown(e){"Escape"!==e.key&&27!==e.keyCode||!this.modal.hasAttribute("disable-esc")||this.closeModal(e),"Tab"!==e.key&&9!==e.keyCode||this.retainFocus(e,"inside")}getFocusableNodes(){return[...this.modal.querySelectorAll(e)]}setFocusToFirstNode(){if(!this.config.disableFocus){var e=this.getFocusableNodes();if(0!==e.length){var t=e.filter(e=>!e.hasAttribute(this.config.closeTrigger));t.length>0&&t[0].focus(),0===t.length&&e[0].focus()}}}retainFocus(e,t){var o=this.getFocusableNodes();if(0!==o.length)if(o=o.filter(e=>null!==e.offsetParent),"outside"===t)o[0].focus(),e.preventDefault();else{var i=o.indexOf(document.activeElement);e.shiftKey&&0===i&&(o[o.length-1].focus(),e.preventDefault()),!e.shiftKey&&o.length>0&&i===o.length-1&&(o[0].focus(),e.preventDefault())}}}var a=e=>{if("string"==typeof e)return e;if(e instanceof HTMLElement){var o=e.getAttribute(t.identifier);return o||(e.id?e.id:(o=t.generateId(),e.setAttribute(t.identifier,o),o))}return null},r=e=>{var t=o[i[i.length-1]];t.modal.contains(document.activeElement)||("Escape"!==e.key&&27!==e.keyCode||null!==t.modal.querySelector('[role="alertdialog"]')||g(),"Tab"!==e.key&&9!==e.keyCode||t.retainFocus(e,"outside"))},l=(e,t)=>e===t||e.parentNode===t,d=function(e,t){return!!(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?void 0!==o[e]:"string"==typeof e?null!==document.getElementById(e):e instanceof HTMLElement)||(t&&console.warn("MicroModal: ❗Seems like you have missed %c'".concat(e,"'%c ID somewhere in your code. Try the example below to resolve it.\n\n")+'%cExample:%c <div class="modal" id="'.concat(e,'"></div>'),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","","background-color: #f8f9fa;color: #50596c;font-weight: bold;",""),!1)},c=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},t,{targetModal:e},i),r=a(e);d(n.targetModal,n.debugMode,!1)&&(o[r]||(o[r]=new s(n),o[r].modal.setAttribute(t.identifier,r),o[r].modalId=r))},h=(e,i)=>{var n=a(e);d(n,t.debugMode)&&Object.assign(o[n].config,i)},g=e=>{if(0!==i.length)if(e){var t=a(e);i.indexOf(t)>-1&&o[t].closeModal()}else o[i[i.length-1]].closeModal()},m=s;return Object.assign(m,{init:e=>{Object.assign(t,e);var o=[...document.querySelectorAll("[".concat(t.openTrigger,"]"))],i=((e,t)=>{var o=[];return e.forEach(e=>{var i=e.getAttribute(t);o[i]||(o[i]=[]),o[i].push(e)}),o})(o,t.openTrigger);!0===t.debugMode&&!1===(e=>!(e.length<=0&&(console.warn('MicroModal: ❗Please specify at least one %c\'micromodal-trigger\'%c data attribute.\n\n%cExample:%c <a href="#" data-micromodal-trigger="my-modal">Open modal</a>',"background-color: #f8f9fa;color: #50596c;font-weight: bold;","","background-color: #f8f9fa;color: #50596c;font-weight: bold;",""),1)))(o)||Object.keys(i).forEach(e=>{var t=i[e];c(e,{targetModal:e,triggers:t})})},initModal:c,config:h,show:(e,t)=>{var i=a(e);o[i]?t&&h(e,t):c(i,t),o[i]&&o[i].showModal()},close:g,closeAll:()=>{for(var e=i.length-1;e>=0;e--)o[i[e]].closeModal()},removeModal:e=>{var t=a(e),i=o[t];i&&(i.destroy(),delete o[t])},options:t}),m})();"undefined"!=typeof window&&(window.MicroModal=e);export{e as default};
